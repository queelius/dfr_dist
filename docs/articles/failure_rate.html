<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="dfr.dist">
<title>Failure rate distributions • dfr.dist</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Failure rate distributions">
<meta property="og:description" content="dfr.dist">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dfr.dist</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/failure_rate.html">Failure rate distributions</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/queelius/dfr_dist/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="failure_rate_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Failure rate distributions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/queelius/dfr_dist/blob/HEAD/vignettes/failure_rate.Rmd" class="external-link"><code>vignettes/failure_rate.Rmd</code></a></small>
      <div class="d-none name"><code>failure_rate.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>One of the most important quantities in reliability theory and survival analysis is the failure rate, often denoted by <span class="math inline">\(\lambda\)</span>. For a system with a random lifetime <span class="math inline">\(T\)</span>, its failure rate over some interval <span class="math inline">\((t, t + \Delta t)\)</span> is the ratio of the probability of failure in that interval <span class="math inline">\((t, t + \Delta t)\)</span> given that the system survived up to the time <span class="math inline">\(t\)</span> divided by the length of the interval <span class="math inline">\(\Delta t\)</span>. That is, <span class="math display">\[
  \lambda = \frac{\Pr(T \leq t + \Delta t | T &gt; t)}{\Delta t}.
\]</span></p>
<p>For instance, if we have a system with a failure rate of <span class="math inline">\(\lambda\)</span> over the interval <span class="math inline">\((t, t + \Delta t)\)</span>, then the probability of failure over this interval, given that it has survived up to time <span class="math inline">\(t\)</span>, is <span class="math inline">\(\lambda \Delta t\)</span>. Of course, for most systems, the failure rate changes over time. For instance, a system may be more likely to fail when it is new, or when it is old.</p>
<p>At the limit, as <span class="math inline">\(\Delta t \to 0\)</span>, we have what is known as the instaneous failure rate, or the hazard function,</p>
<p><span class="math display">\[
h(t) = \lim_{\Delta t \to 0}
  \frac{\Pr\{T \leq t + \Delta t | T &gt; t\}}{\Delta t}.
\]</span></p>
<p>We can rewrite the above expression as <span class="math display">\[
\begin{align}
h(t)
  &amp;= \lim_{\Delta t \to 0}
    \frac{\Pr\{t &lt; T \leq t + \Delta t\}}{ \Pr\{T &gt; t\} \Delta t}\\
  &amp;= \lim_{\Delta t \to 0} \left(\frac{F(t + \Delta t) - F(t)}{\Delta t}\right)
      \frac{1}{ 1 - F(t) }\\
  &amp;= \frac{f(t)}{S(t)},
\end{align}
\]</span> where <span class="math inline">\(f\)</span> is the pdf, <span class="math inline">\(F\)</span> is the cdf, and <span class="math inline">\(S\)</span> is the survival function of <span class="math inline">\(T\)</span>.</p>
<p>The concept of the failure rate or hazard function is the basis of many important lifetime models in survival analysis and reliability theory. In what follows, we consider the dynamic failure rate (DFR) family of distributions, which can be a function of both time and any other predictors or covariates, i.e., <span class="math inline">\(h(t, x)\)</span> may change with respect to both <span class="math inline">\(t\)</span> and the covariate vector <span class="math inline">\(x\)</span>.</p>
</div>
<div class="section level2">
<h2 id="dynamic-failure-rate-dfr-distribution">Dynamic failure rate (DFR) distribution<a class="anchor" aria-label="anchor" href="#dynamic-failure-rate-dfr-distribution"></a>
</h2>
<p>Now, we consider the case where the failure rate is not constant. In fact, we generalize it to be a function of both time and any other predictors, say <span class="math inline">\(t\)</span> and <span class="math inline">\(x\)</span> where <span class="math inline">\(x\)</span> is a vector of covariates <span class="math inline">\((x_1,\ldots,x_p)\)</span>. We denote this function hazard function by <span class="math inline">\(h(t, x)\)</span>.</p>
<p>First, we define the cumulative hazard function. It is defined as <span class="math display">\[
H(t, x) = \int_0^t h(u, x) \, du,
\]</span> which is the expected number of failures up to time <span class="math inline">\(t\)</span>. This is useful in its own right, but it is also useful in defining the survival function. The survival function, <span class="math inline">\(\Pr\{T &gt; t\}\)</span>, is given by <span class="math display">\[
S(t|x) = \exp\left(-\int_0^t h(s, x) \, ds\right).
\]</span></p>
<p>There is a well-known relationship between the survival function, the harzard function, and the pdf, <span class="math display">\[
  h(t, x) =   \frac{f(t|x)}{S(t|x)}.
\]</span> We may rewrite the above expression to define the pdf in terms of the hazard and survival functions, <span class="math display">\[
f(t|x) = h(t, x) S(t|x).
\]</span></p>
<div class="section level4">
<h4 id="common-failure-rate-distributions">Common failure rate distributions<a class="anchor" aria-label="anchor" href="#common-failure-rate-distributions"></a>
</h4>
<p>In what follows, we show how two well-known distributions, the exponential and the Weibull, are defined in this framework.</p>
<ol style="list-style-type: decimal">
<li><p>Exponential distribution: <span class="math display">\[
  h(t, x) = h(t) = \lambda.
\]</span></p></li>
<li><p>Weibull distribution: <span class="math display">\[
  h(t, x) = h(t) =
  \left(\frac{k}{\lambda}\right)\left(\frac{t}{\lambda}\right)^{k-1}.
\]</span></p></li>
</ol>
<p>Of course, we can parameterize any family of distributions in terms of the hazard function. Sometimes, the parameterization yields an analytical form for the cumulative hazard function, which is useful in computing the other related distribution functions, like the survival and pdf.</p>
<p>Even simple hazard functions, when combined with other predictors, can yield complex distribution functions, but first let’s consider a simpler case where the hazard function is only a function of some other predictor <span class="math inline">\(x\)</span>, <span class="math display">\[
h(t, x) = h(x) = \exp(\beta_0 + \beta_1 x),
\]</span> which is just a family of hazard function for an exponential distribution with rate <span class="math inline">\(\lambda = \exp(\beta_0 + \beta_1 x)\)</span>. This is pretty straightforward to estimate, and in fact may be rewritten as: <span class="math display">\[
h(x) = h_0 \exp(\beta_1 x),
\]</span> where <span class="math inline">\(h_0\)</span> is the same for each observation, and <span class="math inline">\(\beta_1\)</span> is the coefficient for the predictor <span class="math inline">\(x\)</span>. We can generalize <span class="math inline">\(h_0\)</span> to be a function of <span class="math inline">\(t\)</span>, in which case we have the proportional hazards model, which is straightforward to estimate, <span class="math display">\[
h(t,x) = h_0(t) \exp(\beta_1 x).
\]</span></p>
<p>Things become more complicated if we have a hazard function in which <span class="math inline">\(t\)</span> and <span class="math inline">\(x\)</span> interact, e.g., <span class="math display">\[
h(t, x) = \exp(\beta0 + \beta_1 t + \beta_1 x + \beta_{1 2} x t).
\]</span> In this case, we no longer have a proportional hazards model, and the estimation of the parameters is more complicated.</p>
</div>
<div class="section level3">
<h3 id="likelihood-function-and-maximum-likelihood-estimation">Likelihood function and maximum likelihood estimation<a class="anchor" aria-label="anchor" href="#likelihood-function-and-maximum-likelihood-estimation"></a>
</h3>
<p>The likelihoon function is a sufficient statistic for the parameters of the distribution. The likelihood function for an observation of an exact failure time is given by <span class="math display">\[
\ell_i(\theta|t_i,x_i) = f(t_i|x_i,\theta),
\]</span> where <span class="math inline">\(\theta\)</span> is the vector of parameters of the distribution, <span class="math inline">\(t_i\)</span> is the exact failure time, and <span class="math inline">\(x_i\)</span> is the vector of predictors for the <span class="math inline">\(i\)</span>th observation in the sample. We denote <span class="math inline">\(l_i\)</span> as a shorthand for <span class="math inline">\(\ell_i(\theta|t_i,x_i)\)</span>, and we call this a likelihood contribution.</p>
<p>If we have a sample in which <span class="math inline">\(n\)</span> are exact failure times, the total likelihood function over these observations is given by <span class="math display">\[
\ell(\theta|t,X) = \prod_{i=1}^n \ell_i(\theta|t_i,X_{i:}),
\]</span> where <span class="math inline">\(t\)</span> is the vector of failure times, <span class="math inline">\(X\)</span> is an <span class="math inline">\(n \times p\)</span> matrix of predictors, and <span class="math inline">\(X_{i:}\)</span> is the <span class="math inline">\(i\)</span>-th row of <span class="math inline">\(X\)</span>, a <span class="math inline">\(1 \times p\)</span> vector of predictors for the <span class="math inline">\(i\)</span>th row of <span class="math inline">\(X\)</span> corresponding to the <span class="math inline">\(i\)</span>th observation in the exact failure time sample.</p>
<p>It is more convenient to work with the log-likelihood function normally, so we define the log-likelihood contribution as <span class="math display">\[
L_i = \log \ell_i.
\]</span> A particularly nice feature of the log-likelihood function is that it is additive, so the total log-likelihood function is given by <span class="math display">\[
L(\theta|t,X) = \sum_{i=1}^n L_i,
\]</span> and thus by the CLT, the log-likelihood function is asymptotically normally distributed. This comes in handy for the MLE, which is asymptotically normally distributed with a mean equal to the true parameter value <span class="math inline">\(\theta\)</span> and a variance equal to the inverse of the Fisher information matrix, assuming the following regularity conditions hold:</p>
<ol style="list-style-type: decimal">
<li>The support of the distribution does not depend on the parameter <span class="math inline">\(\theta\)</span>.</li>
<li>The parameter space is open.</li>
<li>The gradient of the log-likelihood function with respect to <span class="math inline">\(\theta\)</span> exists and is continuous.</li>
<li>The expectation of the gradient of the log-likelihood function with respect to <span class="math inline">\(\theta\)</span> is zero.</li>
</ol>
<p>For our DFR (dynamic failure rate) model, the <span class="math inline">\(i\)</span>-th log-likelihood contribution for the exact failure time is given by <span class="math display">\[\begin{align}
\ell_i &amp;= h(t_i, x_i) S(t_i|x_i)\\
       &amp;= h(t_i, x_i) \exp\left(-H(t_i, x_i)\right)
\end{align}\]</span> where <span class="math inline">\(h\)</span> is the hazard function, <span class="math inline">\(S\)</span> is the survival function, and <span class="math inline">\(H\)</span> is the cumulative hazard function. The log-likelihood function is given by <span class="math display">\[
\begin{align}
\ell_i &amp;= \log \ell_i\\
       &amp;= \log h(t_i, x_i) - H(t_i, x_i),
\end{align}
\]</span> which has a nice form if <span class="math inline">\(H\)</span> has an analytical form, which is the case for many of the well-known distributions, but otherwise we can use the definition of <span class="math inline">\(H\)</span> to compute it numerically.</p>
</div>
<div class="section level3">
<h3 id="score-of-the-likelihood-function">Score of the likelihood function<a class="anchor" aria-label="anchor" href="#score-of-the-likelihood-function"></a>
</h3>
<p>The score of the <span class="math inline">\(i\)</span>-th obserevation for an exact failure time is just the gradient of the <span class="math inline">\(i\)</span>-th log-likelihood contribution, $$ <span class="math display">\[\begin{align}
  s_i = \nabla_{\theta} f(t_i|x_i).
\end{align}\]</span></p>
<p>Let’s rewrite this to get it into a nicer form. First, let’s substitute in the definition of the log-likelihood contribution, <span class="math display">\[
  s_i = \nabla_{\theta} \log h(t_i, x_i) - \nabla_{\theta} H(t_i, x_i).
\]</span> Recall that the cumulative hazard function is defined assuming <span class="math display">\[
  H(t, x) = \int_0^t h(u, x) \, du,
\]</span> and so by the Second Law of the Fundamental Theorem of Calculus, we have <span class="math display">\[
\begin{align}
  s_i &amp;= \nabla_{\theta} \log h(t_i, x_i) - \nabla_{\theta} h(t_i, x_i)\\
      &amp;= \frac{\nabla_{\theta} h(t_i, x_i)}{h(t_i,x_i)} -
        \nabla_{\theta} h(t_i, x_i),
\end{align}
\]</span> where <span class="math inline">\(h\)</span> is the hazard function. This is actually quite good, because for most hazard functions, the hazard function and its gradient can be computed analytically, which may simplify the numerical solution of, say, the MLE problem.</p>
<p>The hessian of the log-likelihood function, or the Jacobian of the score, with respect to <span class="math inline">\(\theta\)</span> is given by <span class="math display">\[
\begin{align}
  \nabla_{\theta} s_i &amp;= \nabla_{\theta} \frac{\nabla_{\theta} h(t_i, x_i)}{h(t_i,x_i)} -
        \nabla_{\theta} \nabla_{\theta} h(t_i, x_i)\\
      &amp;= \frac{\nabla_{\theta}^2 h(t_i, x_i)}{h(t_i,x_i)} -
        \frac{\nabla_{\theta} h(t_i, x_i) \nabla_{\theta} h(t_i, x_i)}{h(t_i,x_i)^2} -
        \nabla_{\theta} \nabla_{\theta} h(t_i, x_i).
\end{align}
\]</span></p>
<p>This is an important result for the MLE, since it allows us to evaluate the variance-covariance of the sampling distribution of the MLE, in addition to other imporatnt quantities the MLEs sensitivity to sampling error. However, normally, we just numerically compute the Hessian and there are many important algorithms that do this for us, particularly for efficiently approximating it for solving efficiently solving for a linear approximation of the the root of the score function.</p>
</div>
</div>
<div class="section level2">
<h2 id="simulation">Simulation<a class="anchor" aria-label="anchor" href="#simulation"></a>
</h2>
<p>We construct a data frame showing mean and variance for each way three ways of it, using <code>mean</code> and <code>vcov</code>, using <code>expectation</code> (defined for all <code>dist</code> objects using Monte Carlo integration), and using the analytical formulae for the mean and variance of the exponential and the definitions of each, and using the sample mean and sample variance.</p>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>We load the R package <code>dfr.dist</code> which contains all of the relevant material in this section with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/queelius/dfr_dist" class="external-link">dfr.dist</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"queelius/dfr_dist"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Loading required package: dfr.dist</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/queelius/dfr_dist" class="external-link">dfr.dist</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/queelius/algebraic.dist" class="external-link">algebraic.dist</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'algebraic.dist'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:grDevices':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     pdf</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">expdist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dfr_dist.html">dfr_dist</a></span><span class="op">(</span>rate <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">par</span>, <span class="va">...</span><span class="op">)</span> <span class="va">par</span>, par <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/is_dfr_dist.html">is_dfr_dist</a></span><span class="op">(</span><span class="va">expdist</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">expdist</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/params.html" class="external-link">params</a></span><span class="op">(</span><span class="va">expdist</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/hazard.html" class="external-link">hazard</a></span><span class="op">(</span><span class="va">expdist</span><span class="op">)</span></span>
<span><span class="va">h</span></span>
<span><span class="co">#&gt; function (t, par = NULL, ...) </span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;     par &lt;- params(x, par)</span></span>
<span><span class="co">#&gt;     x$rate(t, par, ...)</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; &lt;bytecode: 0x55e97564fa50&gt;</span></span>
<span><span class="co">#&gt; &lt;environment: 0x55e975653838&gt;</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span></span>
<span><span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/sup.html" class="external-link">sup</a></span><span class="op">(</span><span class="va">expdist</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mu.hat</span> <span class="op">&lt;-</span> <span class="fu">algebraic.dist</span><span class="fu">::</span><span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/expectation.html" class="external-link">expectation</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">expdist</span>,</span>
<span>  g <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span>, n <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">var.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/algebraic.dist/reference/expectation.html" class="external-link">expectation</a></span><span class="op">(</span><span class="va">dfr.dist</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">mu.hat</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, n <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">$</span><span class="va">value</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  analytical <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dfr.dist</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">dfr.dist</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"variance"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Alexander Towell.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
